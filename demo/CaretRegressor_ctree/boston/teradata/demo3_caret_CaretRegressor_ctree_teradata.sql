-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : CaretRegressor_ctree
-- Dataset : boston
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Model deployment code

WITH "DT_node_lookup" AS 
(SELECT "ADS"."KEY" AS "KEY", CASE WHEN ("ADS"."Feature_12" <= CAST(9.71 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(7.42 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(6.593 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_0" <= CAST(0.62976 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(6.121 AS DOUBLE PRECISION)) THEN 6 ELSE 7 END ELSE 8 END ELSE CASE WHEN ("ADS"."Feature_5" <= CAST(7.107 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_12" <= CAST(5.1 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_8" <= CAST(4.0 AS DOUBLE PRECISION)) THEN 12 ELSE 13 END ELSE CASE WHEN ("ADS"."Feature_10" <= CAST(17.4 AS DOUBLE PRECISION)) THEN 15 ELSE 16 END END ELSE 17 END END ELSE CASE WHEN ("ADS"."Feature_8" <= CAST(5.0 AS DOUBLE PRECISION)) THEN 19 ELSE 20 END END ELSE CASE WHEN ("ADS"."Feature_12" <= CAST(14.98 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_5" <= CAST(6.674 AS DOUBLE PRECISION)) THEN 23 ELSE 24 END ELSE CASE WHEN ("ADS"."Feature_9" <= CAST(437.0 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS"."Feature_6" <= CAST(73.1 AS DOUBLE PRECISION)) THEN 27 ELSE CASE WHEN ("ADS"."Feature_0" <= CAST(0.17446 AS DOUBLE PRECISION)) THEN 29 ELSE 30 END END ELSE CASE WHEN ("ADS"."Feature_12" <= CAST(21.32 AS DOUBLE PRECISION)) THEN 32 ELSE 33 END END END END AS node_id_2 
FROM boston AS "ADS"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"DT_node_data" AS 
(SELECT "Values".nid AS nid, "Values"."E" AS "E" 
FROM (SELECT 6 AS nid, CAST(20.5545454545455 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 7 AS nid, CAST(24.191999999999997 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 8 AS nid, CAST(32.0 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 12 AS nid, CAST(30.533333333333303 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 13 AS nid, CAST(34.3333333333333 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 15 AS nid, CAST(28.9583333333333 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 16 AS nid, CAST(25.733333333333302 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 17 AS nid, CAST(34.5 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 19 AS nid, CAST(46.6 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 20 AS nid, CAST(40.7857142857143 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 23 AS nid, CAST(20.382692307692302 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 24 AS nid, CAST(25.5428571428571 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 27 AS nid, CAST(21.625 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 29 AS nid, CAST(20.4571428571429 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 30 AS nid, CAST(15.8647058823529 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 32 AS nid, CAST(14.756818181818199 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 33 AS nid, CAST(10.478125 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte) AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".nid AS nid, "DT_node_data"."E" AS "E" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".nid)
 SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."E" AS "Estimator" 
FROM "DT_Output"