-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : CaretRegressor_ctree_pca
-- Dataset : diabetes
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Model deployment code

WITH "ADS_sca_1_OUT" AS 
(SELECT "ADS"."KEY" AS "KEY", (CAST("ADS"."Feature_0" AS DOUBLE PRECISION) - CAST(0.000268693206665 AS DOUBLE PRECISION)) / CAST(0.047309153493906 AS DOUBLE PRECISION) AS "Feature_0", (CAST("ADS"."Feature_1" AS DOUBLE PRECISION) - CAST(0.000723958058064 AS DOUBLE PRECISION)) / CAST(0.047673150284254 AS DOUBLE PRECISION) AS "Feature_1", (CAST("ADS"."Feature_2" AS DOUBLE PRECISION) - CAST(0.000728071982559 AS DOUBLE PRECISION)) / CAST(0.047002534484173 AS DOUBLE PRECISION) AS "Feature_2", (CAST("ADS"."Feature_3" AS DOUBLE PRECISION) - CAST(0.001013565221084 AS DOUBLE PRECISION)) / CAST(0.048403881312036 AS DOUBLE PRECISION) AS "Feature_3", (CAST("ADS"."Feature_4" AS DOUBLE PRECISION) - CAST(0.000976358073288 AS DOUBLE PRECISION)) / CAST(0.04811896752595 AS DOUBLE PRECISION) AS "Feature_4", (CAST("ADS"."Feature_5" AS DOUBLE PRECISION) - CAST(0.001764380824234 AS DOUBLE PRECISION)) / CAST(0.048129028508582 AS DOUBLE PRECISION) AS "Feature_5", (CAST("ADS"."Feature_6" AS DOUBLE PRECISION) - CAST(-0.001651281545057 AS DOUBLE PRECISION)) / CAST(0.046267985649893 AS DOUBLE PRECISION) AS "Feature_6", (CAST("ADS"."Feature_7" AS DOUBLE PRECISION) - CAST(0.001390550198339 AS DOUBLE PRECISION)) / CAST(0.047430322447034 AS DOUBLE PRECISION) AS "Feature_7", (CAST("ADS"."Feature_8" AS DOUBLE PRECISION) - CAST(0.001272648254809 AS DOUBLE PRECISION)) / CAST(0.045958003803944 AS DOUBLE PRECISION) AS "Feature_8", (CAST("ADS"."Feature_9" AS DOUBLE PRECISION) - CAST(0.001034425005682 AS DOUBLE PRECISION)) / CAST(0.047829380240755 AS DOUBLE PRECISION) AS "Feature_9" 
FROM diabetes AS "ADS"), 
"ADS_pre_1_OUT" AS 
(SELECT "ADS_sca_1_OUT"."KEY" AS "KEY", "ADS_sca_1_OUT"."Feature_0" * CAST(-0.229077885203853 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_1" * CAST(-0.17537521887733 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_2" * CAST(-0.310146286752301 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_3" * CAST(-0.262668061795463 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_4" * CAST(-0.347905691048373 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_5" * CAST(-0.355931151239537 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_6" * CAST(0.270066789605325 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_7" * CAST(-0.428189605905032 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_8" * CAST(-0.381755405354334 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_9" * CAST(-0.319118586083605 AS DOUBLE PRECISION) AS "PC1", "ADS_sca_1_OUT"."Feature_0" * CAST(0.099371216581334 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_1" * CAST(-0.397407137322293 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_2" * CAST(-0.0955290657434 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_3" * CAST(-0.104282274802339 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_4" * CAST(0.55199449360805 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_5" * CAST(0.441697486214861 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_6" * CAST(0.535979163065434 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_7" * CAST(-0.09747648126824 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_8" * CAST(-0.064645715966041 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_9" * CAST(-0.106973579658861 AS DOUBLE PRECISION) AS "PC2", "ADS_sca_1_OUT"."Feature_0" * CAST(-0.447334397656141 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_1" * CAST(0.065171713108597 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_2" * CAST(-0.181322885781879 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_3" * CAST(-0.563305355080943 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_4" * CAST(0.109988404071375 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_5" * CAST(0.28936391011131 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_6" * CAST(-0.353372283461161 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_7" * CAST(0.3825782441157 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_8" * CAST(-0.044704551335765 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_9" * CAST(-0.276384099594312 AS DOUBLE PRECISION) AS "PC3", "ADS_sca_1_OUT"."Feature_0" * CAST(-0.382147586852069 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_1" * CAST(-0.683347918306126 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_2" * CAST(0.524182097673846 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_3" * CAST(-0.03681239814872 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_4" * CAST(-0.084450107369133 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_5" * CAST(-0.16994357503869 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_6" * CAST(-0.076933401599697 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_7" * CAST(0.01746636608408 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_8" * CAST(0.255444900056057 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_9" * CAST(0.058208776902541 AS DOUBLE PRECISION) AS "PC4", "ADS_sca_1_OUT"."Feature_0" * CAST(-0.73513656379737 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_1" * CAST(0.376385581379546 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_2" * CAST(0.142039339449165 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_3" * CAST(0.392671870019245 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_4" * CAST(0.142865066554186 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_5" * CAST(0.127672630878639 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_6" * CAST(0.245950649429653 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_7" * CAST(-0.128401191982395 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_8" * CAST(-0.136798085189012 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_9" * CAST(0.105540149499879 AS DOUBLE PRECISION) AS "PC5", "ADS_sca_1_OUT"."Feature_0" * CAST(-0.12368487725974 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_1" * CAST(-0.062843875881014 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_2" * CAST(-0.295396923205304 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_3" * CAST(-0.341296031171276 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_4" * CAST(-0.016564490341537 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_5" * CAST(-0.045874387513673 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_6" * CAST(0.080821103815164 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_7" * CAST(-0.030199014358926 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_8" * CAST(-0.005345781056682 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_9" * CAST(0.875876089885882 AS DOUBLE PRECISION) AS "PC6", "ADS_sca_1_OUT"."Feature_0" * CAST(-0.180936452793448 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_1" * CAST(-0.069871374167665 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_2" * CAST(-0.578917333850051 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_3" * CAST(0.228020473778496 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_4" * CAST(0.101269845624599 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_5" * CAST(-0.224620265651816 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_6" * CAST(0.065446141510241 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_7" * CAST(0.038085803656635 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_8" * CAST(0.697931508563453 AS DOUBLE PRECISION) + "ADS_sca_1_OUT"."Feature_9" * CAST(-0.147273260741705 AS DOUBLE PRECISION) AS "PC7" 
FROM "ADS_sca_1_OUT"), 
"DT_node_lookup" AS 
(SELECT "ADS_pre_1_OUT"."KEY" AS "KEY", CASE WHEN ("ADS_pre_1_OUT"."PC1" <= CAST(-0.643445938202 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS_pre_1_OUT"."PC4" <= CAST(-0.99444750218 AS DOUBLE PRECISION)) THEN 3 ELSE CASE WHEN ("ADS_pre_1_OUT"."PC3" <= CAST(-0.479833499925 AS DOUBLE PRECISION)) THEN 5 ELSE CASE WHEN ("ADS_pre_1_OUT"."PC1" <= CAST(-3.053735910372 AS DOUBLE PRECISION)) THEN 7 ELSE 8 END END END ELSE CASE WHEN ("ADS_pre_1_OUT"."PC4" <= CAST(0.6678258227 AS DOUBLE PRECISION)) THEN CASE WHEN ("ADS_pre_1_OUT"."PC1" <= CAST(2.118707548458 AS DOUBLE PRECISION)) THEN 11 ELSE 12 END ELSE CASE WHEN ("ADS_pre_1_OUT"."PC1" <= CAST(0.025881188504 AS DOUBLE PRECISION)) THEN 14 ELSE 15 END END END AS node_id_2 
FROM "ADS_pre_1_OUT"), 
dummy_cte AS 
(SELECT CAST(0.0 AS DOUBLE PRECISION) AS "X"), 
"DT_node_data" AS 
(SELECT "Values".nid AS nid, "Values"."E" AS "E" 
FROM (SELECT 3 AS nid, CAST(145.4 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 5 AS nid, CAST(244.26086956521698 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 7 AS nid, CAST(239.92857142857102 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 8 AS nid, CAST(186.163636363636 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 11 AS nid, CAST(113.54237288135599 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 12 AS nid, CAST(79.95121951219508 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 14 AS nid, CAST(228.461538461538 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte UNION ALL SELECT 15 AS nid, CAST(153.0 AS DOUBLE PRECISION) AS "E" 
FROM dummy_cte) AS "Values"), 
"DT_Output" AS 
(SELECT "DT_node_lookup"."KEY" AS "KEY", "DT_node_lookup".node_id_2 AS node_id_2, "DT_node_data".nid AS nid, "DT_node_data"."E" AS "E" 
FROM "DT_node_lookup" LEFT OUTER JOIN "DT_node_data" ON "DT_node_lookup".node_id_2 = "DT_node_data".nid)
 SELECT "DT_Output"."KEY" AS "KEY", "DT_Output"."E" AS "Estimator" 
FROM "DT_Output"