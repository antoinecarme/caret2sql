-- This SQL code was generated by sklearn2sql (development version).
-- Copyright 2018

-- Model : CaretClassifier_earth
-- Dataset : BreastCancer
-- Database : teradata


-- This SQL code can contain one or more statements, to be executed in the order they appear in this file.



-- Model deployment code

WITH earth_input AS 
(SELECT "ADS"."KEY" AS "KEY", CAST("ADS"."Feature_0" AS DOUBLE PRECISION) AS "Feature_0", CAST("ADS"."Feature_1" AS DOUBLE PRECISION) AS "Feature_1", CAST("ADS"."Feature_2" AS DOUBLE PRECISION) AS "Feature_2", CAST("ADS"."Feature_3" AS DOUBLE PRECISION) AS "Feature_3", CAST("ADS"."Feature_4" AS DOUBLE PRECISION) AS "Feature_4", CAST("ADS"."Feature_5" AS DOUBLE PRECISION) AS "Feature_5", CAST("ADS"."Feature_6" AS DOUBLE PRECISION) AS "Feature_6", CAST("ADS"."Feature_7" AS DOUBLE PRECISION) AS "Feature_7", CAST("ADS"."Feature_8" AS DOUBLE PRECISION) AS "Feature_8", CAST("ADS"."Feature_9" AS DOUBLE PRECISION) AS "Feature_9", CAST("ADS"."Feature_10" AS DOUBLE PRECISION) AS "Feature_10", CAST("ADS"."Feature_11" AS DOUBLE PRECISION) AS "Feature_11", CAST("ADS"."Feature_12" AS DOUBLE PRECISION) AS "Feature_12", CAST("ADS"."Feature_13" AS DOUBLE PRECISION) AS "Feature_13", CAST("ADS"."Feature_14" AS DOUBLE PRECISION) AS "Feature_14", CAST("ADS"."Feature_15" AS DOUBLE PRECISION) AS "Feature_15", CAST("ADS"."Feature_16" AS DOUBLE PRECISION) AS "Feature_16", CAST("ADS"."Feature_17" AS DOUBLE PRECISION) AS "Feature_17", CAST("ADS"."Feature_18" AS DOUBLE PRECISION) AS "Feature_18", CAST("ADS"."Feature_19" AS DOUBLE PRECISION) AS "Feature_19", CAST("ADS"."Feature_20" AS DOUBLE PRECISION) AS "Feature_20", CAST("ADS"."Feature_21" AS DOUBLE PRECISION) AS "Feature_21", CAST("ADS"."Feature_22" AS DOUBLE PRECISION) AS "Feature_22", CAST("ADS"."Feature_23" AS DOUBLE PRECISION) AS "Feature_23", CAST("ADS"."Feature_24" AS DOUBLE PRECISION) AS "Feature_24", CAST("ADS"."Feature_25" AS DOUBLE PRECISION) AS "Feature_25", CAST("ADS"."Feature_26" AS DOUBLE PRECISION) AS "Feature_26", CAST("ADS"."Feature_27" AS DOUBLE PRECISION) AS "Feature_27", CAST("ADS"."Feature_28" AS DOUBLE PRECISION) AS "Feature_28", CAST("ADS"."Feature_29" AS DOUBLE PRECISION) AS "Feature_29" 
FROM "BreastCancer" AS "ADS"), 
earth_cte AS 
(SELECT earth_input."KEY" AS "KEY", CAST(-20276.6860699524 AS DOUBLE PRECISION) * greatest(earth_input."Feature_7" - CAST(0.09431 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(12218.88993541963 AS DOUBLE PRECISION) * greatest(CAST(0.09431 AS DOUBLE PRECISION) - earth_input."Feature_7", CAST(0 AS DOUBLE PRECISION)) + CAST(-2.380924151983417 AS DOUBLE PRECISION) * greatest(earth_input."Feature_23" - CAST(1269.0 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(0.866863452412413 AS DOUBLE PRECISION) * greatest(CAST(1269.0 AS DOUBLE PRECISION) - earth_input."Feature_23", CAST(0 AS DOUBLE PRECISION)) + CAST(412.90118461426016 AS DOUBLE PRECISION) * greatest(earth_input."Feature_27" - CAST(0.09594 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(-1746.160659578372 AS DOUBLE PRECISION) * greatest(CAST(0.09594 AS DOUBLE PRECISION) - earth_input."Feature_27", CAST(0 AS DOUBLE PRECISION)) + CAST(190.51083729253182 AS DOUBLE PRECISION) * greatest(earth_input."Feature_0" - CAST(17.68 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(-207.88664437327117 AS DOUBLE PRECISION) * greatest(CAST(17.68 AS DOUBLE PRECISION) - earth_input."Feature_0", CAST(0 AS DOUBLE PRECISION)) + CAST(7.36935004246159 AS DOUBLE PRECISION) * greatest(earth_input."Feature_1" - CAST(23.29 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(-856.317907797136 AS DOUBLE PRECISION) * greatest(earth_input."Feature_28" - CAST(0.2226 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(-3195.2534672226648 AS DOUBLE PRECISION) * greatest(CAST(0.2226 AS DOUBLE PRECISION) - earth_input."Feature_28", CAST(0 AS DOUBLE PRECISION)) + CAST(-4.570803216789019 AS DOUBLE PRECISION) * greatest(CAST(158.8 AS DOUBLE PRECISION) - earth_input."Feature_22", CAST(0 AS DOUBLE PRECISION)) + CAST(819.6893984092267 AS DOUBLE PRECISION) * greatest(earth_input."Feature_16" - CAST(0.05554 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(2268.774345428007 AS DOUBLE PRECISION) * greatest(CAST(0.05554 AS DOUBLE PRECISION) - earth_input."Feature_16", CAST(0 AS DOUBLE PRECISION)) + CAST(397.06434654544563 AS DOUBLE PRECISION) * greatest(earth_input."Feature_27" - CAST(0.1674 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(-1048.494561328608 AS DOUBLE PRECISION) * greatest(earth_input."Feature_27" - CAST(0.1181 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(22616.719784892462 AS DOUBLE PRECISION) * greatest(CAST(0.01096 AS DOUBLE PRECISION) - earth_input."Feature_18", CAST(0 AS DOUBLE PRECISION)) + CAST(-0.786275628604977 AS DOUBLE PRECISION) * greatest(CAST(674.5 AS DOUBLE PRECISION) - earth_input."Feature_3", CAST(0 AS DOUBLE PRECISION)) + CAST(2.529194000551864 AS DOUBLE PRECISION) * greatest(earth_input."Feature_23" - CAST(1175.0 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(-3247.063924841283 AS DOUBLE PRECISION) * greatest(CAST(0.1479 AS DOUBLE PRECISION) - earth_input."Feature_5", CAST(0 AS DOUBLE PRECISION)) + CAST(20175.91910112512 AS DOUBLE PRECISION) * greatest(earth_input."Feature_7" - CAST(0.07488 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(-10775.18163906298 AS DOUBLE PRECISION) * greatest(CAST(0.05892 AS DOUBLE PRECISION) - earth_input."Feature_6", CAST(0 AS DOUBLE PRECISION)) + CAST(1270.5851895563987 AS DOUBLE PRECISION) * greatest(CAST(0.2687 AS DOUBLE PRECISION) - earth_input."Feature_26", CAST(0 AS DOUBLE PRECISION)) + CAST(198.7727796283102 AS DOUBLE PRECISION) * greatest(CAST(0.5391 AS DOUBLE PRECISION) - earth_input."Feature_11", CAST(0 AS DOUBLE PRECISION)) + CAST(-8.557613585377194 AS DOUBLE PRECISION) * greatest(earth_input."Feature_1" - CAST(19.22 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(1.336414986853243 AS DOUBLE PRECISION) * greatest(earth_input."Feature_22" - CAST(128.7 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(-3.456761071624524 AS DOUBLE PRECISION) * greatest(earth_input."Feature_22" - CAST(97.58 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(31.847631901572647 AS DOUBLE PRECISION) * greatest(CAST(91.12 AS DOUBLE PRECISION) - earth_input."Feature_2", CAST(0 AS DOUBLE PRECISION)) + CAST(-208.4114979295069 AS DOUBLE PRECISION) * greatest(earth_input."Feature_0" - CAST(14.22 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(4763.523437576099 AS DOUBLE PRECISION) * greatest(earth_input."Feature_24" - CAST(0.1782 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(286.8939053683233 AS DOUBLE PRECISION) * greatest(CAST(0.1782 AS DOUBLE PRECISION) - earth_input."Feature_24", CAST(0 AS DOUBLE PRECISION)) + CAST(96.79812750730221 AS DOUBLE PRECISION) * greatest(earth_input."Feature_25" - CAST(0.611 AS DOUBLE PRECISION), CAST(0 AS DOUBLE PRECISION)) + CAST(260.26228755048453 AS DOUBLE PRECISION) AS earth 
FROM earth_input), 
dot_prod_logistic AS 
(SELECT earth_cte."KEY" AS "KEY", earth_cte.earth AS dot_prod, CAST(1.0 AS DOUBLE PRECISION) / (CAST(1.0 AS DOUBLE PRECISION) + exp(least(CAST(100.0 AS DOUBLE PRECISION), greatest(-CAST(100.0 AS DOUBLE PRECISION), -earth_cte.earth)))) AS logistic 
FROM earth_cte)
 SELECT dot_prod_logistic."KEY" AS "KEY", CAST(NULL AS DOUBLE PRECISION) AS "Score_0", CAST(NULL AS DOUBLE PRECISION) AS "Score_1", CAST(1.0 AS DOUBLE PRECISION) - dot_prod_logistic.logistic AS "Proba_0", dot_prod_logistic.logistic AS "Proba_1", CASE WHEN (CAST(1.0 AS DOUBLE PRECISION) - dot_prod_logistic.logistic IS NULL OR CAST(1.0 AS DOUBLE PRECISION) - dot_prod_logistic.logistic > CAST(0.0 AS DOUBLE PRECISION)) THEN ln(CAST(1.0 AS DOUBLE PRECISION) - dot_prod_logistic.logistic) ELSE -1.79769313486231e+308 END AS "LogProba_0", CASE WHEN (dot_prod_logistic.logistic IS NULL OR dot_prod_logistic.logistic > CAST(0.0 AS DOUBLE PRECISION)) THEN ln(dot_prod_logistic.logistic) ELSE -1.79769313486231e+308 END AS "LogProba_1", CASE WHEN (dot_prod_logistic.dot_prod > CAST(0.0 AS DOUBLE PRECISION)) THEN 1 ELSE 0 END AS "Decision", greatest(CAST(1.0 AS DOUBLE PRECISION) - dot_prod_logistic.logistic, dot_prod_logistic.logistic) AS "DecisionProba" 
FROM dot_prod_logistic